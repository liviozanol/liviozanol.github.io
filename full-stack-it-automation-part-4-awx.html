<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Livio&#39;s Dump RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Livio&#39;s Dump Atom Feed"><title data-react-helmet="true">Full-Stack Automation Part 4 - AWX | Livio&#x27;s Dump</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://livio.zanol.com.br/full-stack-it-automation-part-4-awx"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Full-Stack Automation Part 4 - AWX | Livio&#x27;s Dump"><meta data-react-helmet="true" name="description" content="Ansible/AWX"><meta data-react-helmet="true" property="og:description" content="Ansible/AWX"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-12-08T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/liviozanol"><meta data-react-helmet="true" property="article:tag" content="automation,awx,ansible,gitlab,network automation,terraform,playbook,inventory"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://livio.zanol.com.br/full-stack-it-automation-part-4-awx"><link data-react-helmet="true" rel="alternate" href="https://livio.zanol.com.br/full-stack-it-automation-part-4-awx" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://livio.zanol.com.br/full-stack-it-automation-part-4-awx" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.72c6fd0a.css">
<link rel="preload" href="/assets/js/runtime~main.767ad4ec.js" as="script">
<link rel="preload" href="/assets/js/main.9605fe9c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/lzp-small.svg" alt="Logo" class="themedImage_TMUO themedImage--light_4Vu1" height="32" width="32"><img src="/img/lzp-small.svg" alt="Logo" class="themedImage_TMUO themedImage--dark_uzRr" height="32" width="32"></div><b class="navbar__title">Livio&#x27;s Dump</b></a><a href="https://github.com/liviozanol" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><a href="mailto:livio@zanol.com.br" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>E-mail: livio@zanol.com.br<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">All posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/full-stack-it-automation-part-10-demo-ui">Full-Stack Automation Part 10 - Demo - UI</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/full-stack-it-automation-part-9-demo-api">Full-Stack Automation Part 9 - Demo - API</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/full-stack-it-automation-part-8-demo-gitlab-runner">Full-Stack Automation Part 8 - Demo - Runner</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/full-stack-it-automation-part-7-demo-awx">Full-Stack Automation Part 7 - Demo - AWX</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/full-stack-it-automation-part-6-demo-scenario">Full-Stack Automation Part 6 - Demo -Scenario</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/full-stack-it-automation-part-5-gitlabci">Full-Stack Automation Part 5 - Gitlab CI</a></li><li class="sidebarItem_cjdF"><a aria-current="page" class="sidebarItemLink_zyXk sidebarItemLinkActive_wcJs" href="/full-stack-it-automation-part-4-awx">Full-Stack Automation Part 4 - AWX</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/full-stack-it-automation-part-3-Vault">Full-Stack Automation Part 3 - Vault</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/full-stack-it-automation-part-2-gitlab">Full-Stack Automation Part 2 - Gitlab</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/full-stack-it-automation-part-1">Full-Stack Automation Part 1 - Overview</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/first">First Post</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Full-Stack Automation Part 4 - AWX</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2021-12-08T00:00:00.000Z" itemprop="datePublished">December 8, 2021</time> Â· <!-- -->6 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/liviozanol" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://github.com/liviozanol.png" alt="LÃ­vio Zanol Puppim"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/liviozanol" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">LÃ­vio Zanol Puppim</span></a></div><small class="avatar__subtitle" itemprop="description">Me</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ansible-awx">Ansible/AWX<a aria-hidden="true" class="hash-link" href="#ansible-awx" title="Direct link to heading">â€‹</a></h2><p>Ansible is an automation platform that supports a wide range of functions and can be used to automate almost anything: From network devices from different manufacturers to custom web APIs. The choice for ansible in this layer is for this reason and also because of AWX.</p><p>AWX is a complete automation solution based on ansible. It boosts ansible adding a lot of functionalities to make a complete automation tool mainly introducing a nice web system. Some cool functionalities includes:</p><ul><li>A web interface where you can make all life-cycle related activities with playbooks (monitor, execute, cancel, group, etc.). You still create the playbooks external.</li><li>Workflow of playbooks where you can execute one or more playbooks in sequence giving certain circumstances and even insert approval tasks!</li><li>Nice web forms with basic data validation to start playbooks execution.</li><li>Notification of jobs status using e-mail, telegram, rocketchat, etc.</li><li>Integration with git or other sources to read inventories and playbooks.</li><li>LDAP and other integrations to authentication/authorization.</li><li>And more important: A complete REST API that gives access to all of the above and more!</li></ul><p>Note that AWX comes with a form to play tasks/playbooks that could be used for more simple automations. If you have small tight teams to OAMP only some infrastructure you could use it directly. But secrets for automated resources could be leaked and I do not think that this is a good solution for end-user direct intervention. So do it at your own risk.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ansible-role">Ansible/AWX Role<a aria-hidden="true" class="hash-link" href="#ansible-role" title="Direct link to heading">â€‹</a></h2><p>Ansible/AWX is the &quot;engine&quot; that will access automation elements and execute actions to implement the changes submitted by the user (i.e. run a playbook) and validated by API and CI/CD.</p><ul><li>It talks to any automated resource to execute change actions.</li><li>It talks to hashicorp vault 1 to get keys/pass to access the automated resources</li><li>It talks to gitlab to get inventories, playbooks and complementary files (templates, etc.).</li><li>It receives API requests from Gitlab CI to start and monitor jobs/playbooks.</li></ul><p>Even if AWX has an approval task on workflows, the solution described here won&#x27;t use it. Since AWX has access to sensitive data, like key or pass to access infrastructure resources, we need to minimize any human intervention on it and also its point of contact with other infrastructure. Only gitlab CI/CD will talk actively to AWX on full-stack automation architecture. AWX solution will be used solely as a way to start and monitor tasks execution.</p><p><img alt="AWX/ansible role on architecture" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSIzMTlweCIgaGVpZ2h0PSIyNDNweCIgdmlld0JveD0iLTAuNSAtMC41IDMxOSAyNDMiIGNvbnRlbnQ9IiZsdDtteGZpbGUgaG9zdD0mcXVvdDthcHAuZGlhZ3JhbXMubmV0JnF1b3Q7IG1vZGlmaWVkPSZxdW90OzIwMjEtMTItMDlUMTY6MzM6NDcuMTkxWiZxdW90OyBhZ2VudD0mcXVvdDs1LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzk2LjAuNDY2NC40NSBTYWZhcmkvNTM3LjM2JnF1b3Q7IHZlcnNpb249JnF1b3Q7MTUuOC45JnF1b3Q7IGV0YWc9JnF1b3Q7dHR3ejUwSkZtNDhQRVJ2TEN4RnImcXVvdDsgdHlwZT0mcXVvdDtnb29nbGUmcXVvdDsmZ3Q7Jmx0O2RpYWdyYW0gaWQ9JnF1b3Q7UDhPbTZ6Ri1sRzJzMG1aOVJhZG8mcXVvdDsmZ3Q7NVZqYmp0b3dFUDBhcFBhaHExd0loRWRnbDkxSzdVdVJ1dkJva2lGeGF6S3A0eXloWDE4bkdaT2tXZFR0UmFDbEwrQTU0N0V6Wjg0NGw0RTczeFgza3FYeFJ3eEJEQndyTEFidTdjQnh2S0d0ZjB2Z1VBTytOYW1CU1BLd2h1d0dXUEx2UUtCRmFNNUR5RG9URmFKUVBPMkNBU1lKQktxRE1TbHgzNTIyUmRIZE5XVVI5SUJsd0VRZmZlU2hpaWtMWjl6Z0Q4Q2oyT3hzanlpL0hUT1RLWk1zWmlIdVc1QjdOM0RuRWxIVm8xMHhCMUZ5WjNpcDR4WW52TWNMazVDb2x3UTRkY0FURXpubGRzK1ZZQnU2T25Vd0tVdk1reERLS0h2Z3p2WXhWN0JNV1ZCNjk3ckdHb3ZWVHBCN3k0V1lvMEJaeGJvaEEzOGJhRHhURXI5Q3kyTlo0OFZpY2ZRWU1qVU5NN293a0FxS2s4blpSOHEwMUFCM29PUkJUNkVBMTNkdnZEcUloS1kzck8xOVU3WVJRWEdyWWg1aGpJUVNIZGR1dU5RRG92TjVhdDBlaHhCcUZaR1pZS0wvWmcydGxyWlFxaGdqVEpqNGdKZ1NtVjlBcVFQMUFNc1ZkcW1HZ3F0VmE3d3VsOUpaMTladFFTdFh4c0VZaVU1bFZVMTBQR092elNLbDBjUlZsZ25NRkpOcVdqWlFrMEdGTFhoSkEwV0Vaa1lnV0pieG9BWnB5citWUjhsb1J4d1o1aklnYUVnbkE1TVJVRjM5RjB0SWdtQ0tQM1ZYL3hzNURFOTJtalYvZnlYdE51dzAyL0NNemVhZHRkbWFCbHUzKyt0WHpYYkZ2ZWIzZTIxeXVWNGJ2WUtqdDYyRmxqU3VWUTNtMGUwU2NoaWY5M0Q0RXpuWS81a2NuTXVwd2UvZGlLZEp4amRhQzg1STZHdVpiYVFlUmVWbytyaTZpanV6Wis3RUYzZ01udlRvZm1CWnpBT1VhWi93enl6WGlHTTVWMG43OFJBOEErMW1xN2JNOVpHbFgwQTFpVDNlUHdIMWE4OWprQzBtcWxPUjBiY2NqZU5kVmgyS1V6M0JUNHZHWnhaNUE5Rk4yY3FZSzVCdnpaSTZoWHBWczlQSmtsdXZwdVFqNTZlU1Q4Ym1GYlJWZFArNW9udS9YWFJ0Tmw4S0tsL3JjNHQ3OXdNPSZsdDsvZGlhZ3JhbSZndDsmbHQ7L214ZmlsZSZndDsiPjxkZWZzLz48Zz48cmVjdCB4PSIwLjUiIHk9IjkxIiB3aWR0aD0iNjAiIGhlaWdodD0iNTAiIHJ4PSI3LjUiIHJ5PSI3LjUiIGZpbGw9IiNkYWU4ZmMiIHN0cm9rZT0iIzAwN2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5IiBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDU4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogMTE2cHg7IG1hcmdpbi1sZWZ0OiAycHg7Ij48ZGl2IGRhdGEtZHJhd2lvLWNvbG9ycz0iY29sb3I6IHJnYigwLCAwLCAwKTsgIiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwcHg7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyBwb2ludGVyLWV2ZW50czogYWxsOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7Ij5HaXRsYWI8L2Rpdj48L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PHRleHQgeD0iMzEiIHk9IjEyMCIgZmlsbD0icmdiKDAsIDAsIDApIiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXNpemU9IjEycHgiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkdpdGxhYjwvdGV4dD48L3N3aXRjaD48L2c+PHBhdGggZD0iTSA2MSAyMTYgTCAxMjYuMzQgMTQ2Ljk4IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDdmZmYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ic3Ryb2tlIi8+PHBhdGggZD0iTSAxMzAuNDYgMTQyLjYyIEwgMTI3Ljg3IDE1MS4xOCBMIDEyNi4zNCAxNDYuOTggTCAxMjIuMDYgMTQ1LjY4IFoiIGZpbGw9IiMwMDdmZmYiIHN0cm9rZT0iIzAwN2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48cmVjdCB4PSIxIiB5PSIxOTEiIHdpZHRoPSI2MCIgaGVpZ2h0PSI1MCIgcng9IjcuNSIgcnk9IjcuNSIgZmlsbD0iI2RhZThmYyIgc3Ryb2tlPSIjMDA3ZmZmIiBzdHJva2Utd2lkdGg9IjIiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiIHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogNThweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiAyMTZweDsgbWFyZ2luLWxlZnQ6IDJweDsiPjxkaXYgZGF0YS1kcmF3aW8tY29sb3JzPSJjb2xvcjogcmdiKDAsIDAsIDApOyAiIHN0eWxlPSJib3gtc2l6aW5nOiBib3JkZXItYm94OyBmb250LXNpemU6IDBweDsgdGV4dC1hbGlnbjogY2VudGVyOyI+PGRpdiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHBvaW50ZXItZXZlbnRzOiBhbGw7IHdoaXRlLXNwYWNlOiBub3JtYWw7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsiPkdpdGxhYiBDSTwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIzMSIgeT0iMjIwIiBmaWxsPSJyZ2IoMCwgMCwgMCkiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiIGZvbnQtc2l6ZT0iMTJweCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+R2l0bGFiIENJPC90ZXh0Pjwvc3dpdGNoPjwvZz48cGF0aCBkPSJNIDE0NyA5MSBMIDE0NyA1OS4yNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDA3ZmZmIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9InN0cm9rZSIvPjxwYXRoIGQ9Ik0gMTQ3IDUzLjI0IEwgMTUxIDYxLjI0IEwgMTQ3IDU5LjI0IEwgMTQzIDYxLjI0IFoiIGZpbGw9IiMwMDdmZmYiIHN0cm9rZT0iIzAwN2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48cGF0aCBkPSJNIDE3NyAxMTYgTCAyMjguNzYgMTE2IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDdmZmYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ic3Ryb2tlIi8+PHBhdGggZD0iTSAyMzQuNzYgMTE2IEwgMjI2Ljc2IDEyMCBMIDIyOC43NiAxMTYgTCAyMjYuNzYgMTEyIFoiIGZpbGw9IiMwMDdmZmYiIHN0cm9rZT0iIzAwN2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48cGF0aCBkPSJNIDExNyAxMTYgTCA2OC43NCAxMTYiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwN2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJzdHJva2UiLz48cGF0aCBkPSJNIDYyLjc0IDExNiBMIDcwLjc0IDExMiBMIDY4Ljc0IDExNiBMIDcwLjc0IDEyMCBaIiBmaWxsPSIjMDA3ZmZmIiBzdHJva2U9IiMwMDdmZmYiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PHJlY3QgeD0iMTE3IiB5PSI5MSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjUwIiByeD0iNy41IiByeT0iNy41IiBmaWxsPSIjZGFlOGZjIiBzdHJva2U9IiMwMDdmZmYiIHN0cm9rZS13aWR0aD0iMiIgcG9pbnRlci1ldmVudHM9ImFsbCIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0wLjUgLTAuNSkiPjxzd2l0Y2g+PGZvcmVpZ25PYmplY3QgcG9pbnRlci1ldmVudHM9Im5vbmUiIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSIgc3R5bGU9Im92ZXJmbG93OiB2aXNpYmxlOyB0ZXh0LWFsaWduOiBsZWZ0OyI+PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiB1bnNhZmUgY2VudGVyOyBqdXN0aWZ5LWNvbnRlbnQ6IHVuc2FmZSBjZW50ZXI7IHdpZHRoOiA1OHB4OyBoZWlnaHQ6IDFweDsgcGFkZGluZy10b3A6IDExNnB4OyBtYXJnaW4tbGVmdDogMTE4cHg7Ij48ZGl2IGRhdGEtZHJhd2lvLWNvbG9ycz0iY29sb3I6IHJnYigwLCAwLCAwKTsgIiBzdHlsZT0iYm94LXNpemluZzogYm9yZGVyLWJveDsgZm9udC1zaXplOiAwcHg7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyBwb2ludGVyLWV2ZW50czogYWxsOyB3aGl0ZS1zcGFjZTogbm9ybWFsOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7Ij5BbnNpYmxlPGJyIC8+QVdYPC9kaXY+PC9kaXY+PC9kaXY+PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjE0NyIgeT0iMTIwIiBmaWxsPSJyZ2IoMCwgMCwgMCkiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiIGZvbnQtc2l6ZT0iMTJweCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+QW5zaWJsZS4uLjwvdGV4dD48L3N3aXRjaD48L2c+PHJlY3QgeD0iMTE3IiB5PSIxIiB3aWR0aD0iNjAiIGhlaWdodD0iNTAiIHJ4PSI3LjUiIHJ5PSI3LjUiIGZpbGw9IiNkYWU4ZmMiIHN0cm9rZT0iIzAwN2ZmZiIgc3Ryb2tlLXdpZHRoPSIyIiBwb2ludGVyLWV2ZW50cz0iYWxsIi8+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTAuNSAtMC41KSI+PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBwb2ludGVyLWV2ZW50cz0ibm9uZSIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5IiBzdHlsZT0ib3ZlcmZsb3c6IHZpc2libGU7IHRleHQtYWxpZ246IGxlZnQ7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IHVuc2FmZSBjZW50ZXI7IGp1c3RpZnktY29udGVudDogdW5zYWZlIGNlbnRlcjsgd2lkdGg6IDU4cHg7IGhlaWdodDogMXB4OyBwYWRkaW5nLXRvcDogMjZweDsgbWFyZ2luLWxlZnQ6IDExOHB4OyI+PGRpdiBkYXRhLWRyYXdpby1jb2xvcnM9ImNvbG9yOiByZ2IoMCwgMCwgMCk7ICIgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IGFsbDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyI+SGFzaGljb3JwPGJyIC8+VmF1bHQgMjwvZGl2PjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIxNDciIHk9IjMwIiBmaWxsPSJyZ2IoMCwgMCwgMCkiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiIGZvbnQtc2l6ZT0iMTJweCIgdGV4dC1hbmNob3I9Im1pZGRsZSI+SGFzaGljb3JwLi4uPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIyMzciIHk9Ijg4LjUiIHdpZHRoPSI4MCIgaGVpZ2h0PSI1NSIgZmlsbD0iI2RhZThmYyIgc3Ryb2tlPSIjMDA3ZmZmIiBzdHJva2Utd2lkdGg9IjIiIHBvaW50ZXItZXZlbnRzPSJhbGwiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMC41IC0wLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHBvaW50ZXItZXZlbnRzPSJub25lIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiIHN0eWxlPSJvdmVyZmxvdzogdmlzaWJsZTsgdGV4dC1hbGlnbjogbGVmdDsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogdW5zYWZlIGNlbnRlcjsganVzdGlmeS1jb250ZW50OiB1bnNhZmUgY2VudGVyOyB3aWR0aDogNzhweDsgaGVpZ2h0OiAxcHg7IHBhZGRpbmctdG9wOiAxMTZweDsgbWFyZ2luLWxlZnQ6IDIzOHB4OyI+PGRpdiBkYXRhLWRyYXdpby1jb2xvcnM9ImNvbG9yOiByZ2IoMCwgMCwgMCk7ICIgc3R5bGU9ImJveC1zaXppbmc6IGJvcmRlci1ib3g7IGZvbnQtc2l6ZTogMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgcG9pbnRlci1ldmVudHM6IGFsbDsgd2hpdGUtc3BhY2U6IG5vcm1hbDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyI+QXV0b21hdGVkPGJyIC8+UmVzb3VyY2U8YnIgLz48Zm9udCBzdHlsZT0iZm9udC1zaXplOiA4cHgiPihlZy4gcm91dGVyKTwvZm9udD48L2Rpdj48L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q+PHRleHQgeD0iMjc3IiB5PSIxMjAiIGZpbGw9InJnYigwLCAwLCAwKSIgZm9udC1mYW1pbHk9IkhlbHZldGljYSIgZm9udC1zaXplPSIxMnB4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5BdXRvbWF0ZWQuLi48L3RleHQ+PC9zd2l0Y2g+PC9nPjwvZz48c3dpdGNoPjxnIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSIvPjxhIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAsLTUpIiB4bGluazpocmVmPSJodHRwczovL3d3dy5kaWFncmFtcy5uZXQvZG9jL2ZhcS9zdmctZXhwb3J0LXRleHQtcHJvYmxlbXMiIHRhcmdldD0iX2JsYW5rIj48dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEwcHgiIHg9IjUwJSIgeT0iMTAwJSI+Vmlld2VyIGRvZXMgbm90IHN1cHBvcnQgZnVsbCBTVkcgMS4xPC90ZXh0PjwvYT48L3N3aXRjaD48L3N2Zz4="></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ansible-alternatives">Ansible/AWX Alternatives<a aria-hidden="true" class="hash-link" href="#ansible-alternatives" title="Direct link to heading">â€‹</a></h2><p>You can use other automation tools you like, but since the solution is using AWX as an API to execute and monitor jobs, it&#x27;s important that you execute it using ansible playbooks. Since ansible can execute any arbitrary shell and python command (and others if you install it), you can use <a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">terraform</a>, <a href="https://nornir.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">nornir</a>, <a href="https://napalm.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">napalm</a>, <a href="https://en.wikipedia.org/wiki/Expect" target="_blank" rel="noopener noreferrer">expect</a>, custom scripts, whatever, but it needs to be called from ansible. You can, for example, install custom linux packages on ansible job execution containers and just call a shell script in a playbook.</p><p>Yes, ansible can be <a href="https://networklore.com/ansible-nornir-speed/" target="_blank" rel="noopener noreferrer">slow in some situations</a>, and templates or <a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_templating.html" target="_blank" rel="noopener noreferrer">jinja2</a> like language sometimes are too much complex and boring to write, but for this architecture, objetiving a manufacturer agnostic and wide range automation, its important. If you need high speeds or don&#x27;t like ansible at all, you can use your preferred automation tool through ansible as explained, or just build a new API for you custom automation tool - if it doesn&#x27;t have (and insert a MQ solution as stated on gitlab session).</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ansible-install-config">Ansible/AWX Installation and Configuration<a aria-hidden="true" class="hash-link" href="#ansible-install-config" title="Direct link to heading">â€‹</a></h2><p>First, if you haven&#x27;t cloned the architecture repo from github, please do so: <code>git clone https://github.com/liviozanol/full-stack_automation</code></p><p>TL;DR: Simply run the shell script</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">sudo /bin/bash installation/awx/create_awx.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In this guide AWX/ansible will be installed using docker-compose (which is not indicated for production - should be kubernetes instead). Will be used the <a href="https://github.com/ansible/awx/blob/devel/tools/docker-compose/README.md" target="_blank" rel="noopener noreferrer">&quot;official&quot; awx docker-compose guide</a>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You need to have jq (used by script), ansible, openssl, docker and docker-compose available. Docker service must be running and healthy (check with <code>sudo docker ps</code> or similar).</p><p>As of 2021-12-07, you also need to be able to execute <code>make</code> (i.e.: build-essential, make, automake, gcc, etc.).</p><p>The steps below are already done by the script, which also makes some bugfixes. They are here only for information.</p></div></div><p>1- Clone AWX Repo (version 19.5.0)</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone -b </span><span class="token number" style="color:#36acaa">19.5</span><span class="token plain">.0 https://github.com/ansible/awx.git</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>2- CD to the directory</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> awx</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>3- Change passwords/secrets</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sed</span><span class="token plain"> -i </span><span class="token string" style="color:#e3116c">&#x27;s/# pg_password=&quot;&quot;/pg_password=&quot;fullstack_automation_pg&quot;/g;s/# broadcast_websocket_secret=&quot;&quot;/broadcast_websocket_secret=&quot;fullstack_automation_broadcast_websocket&quot;/g;s/# secret_key=&quot;&quot;/secret_key=&quot;fullstack_automation_secret&quot;/g&#x27;</span><span class="token plain"> tools/docker-compose/inventory</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>4- Build the image</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">make</span><span class="token plain"> docker-compose-build</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>5- Run AWX</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">make</span><span class="token plain"> docker-compose </span><span class="token assign-left variable" style="color:#36acaa">COMPOSE_UP_OPTS</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">-d</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>6- Enable WEB UI (not required but good for troubleshooting)</p><div class="admonition admonition-warning alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>warning</h5></div><div class="admonition-content"><p>Please wait about 5 minutes so AWX is up and running before issuing this command</p></div></div><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token builtin class-name">exec</span><span class="token plain"> tools_awx_1 </span><span class="token function" style="color:#d73a49">make</span><span class="token plain"> clean-ui ui-devel</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>7- Change default admin password</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">docker </span><span class="token builtin class-name">exec</span><span class="token plain"> -it tools_awx_1 </span><span class="token function" style="color:#d73a49">bash</span><span class="token plain"> -c </span><span class="token string" style="color:#e3116c">&quot;awx-manage update_password --username=admin --password=awx-fullstackautomationpass&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><hr><p>Below steps can also be done using AWX web UI, but for simplicity, everything will be done using its REST API.</p><p>8- Create an organization that will be used to further commands</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">AWX_ORG_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">curl</span><span class="token variable" style="color:#36acaa"> -sk --request POST https://admin:awx-fullstackautomationpass@localhost:8043/api/v2/organizations/ -H </span><span class="token variable string" style="color:#e3116c">&quot;Content-Type: application/json&quot;</span><span class="token variable" style="color:#36acaa"> --data </span><span class="token variable string" style="color:#e3116c">&#x27;{&quot;description&quot;: &quot;full stack organization&quot;, &quot;name&quot;: &quot;FULLSTACK_INC&quot;}&#x27;</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> jq .id</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Adding Default Galaxy Credential to Organization. (Needed to install custom collections from ansible galaxy)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> -sk --request POST https://admin:awx-fullstackautomationpass@localhost:8043/api/v2/organizations/</span><span class="token variable" style="color:#36acaa">$AWX_ORG_ID</span><span class="token plain">/galaxy_credentials/ -H </span><span class="token string" style="color:#e3116c">&quot;Content-Type: application/json&quot;</span><span class="token plain"> --data </span><span class="token string" style="color:#e3116c">&#x27;{&quot;id&quot;: 2}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> jq .id</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>9- Create a user that will be used by GITLAB-CI to start and monitor jobs/playbooks</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">AWX_USER_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">curl</span><span class="token variable" style="color:#36acaa"> -sk --request POST https://admin:awx-fullstackautomationpass@localhost:8043/api/v2/organizations/$AWX_ORG_ID/users/ -H </span><span class="token variable string" style="color:#e3116c">&quot;Content-Type: application/json&quot;</span><span class="token variable" style="color:#36acaa"> --data </span><span class="token variable string" style="color:#e3116c">&#x27;{&quot;email&quot;: &quot;user@fullstackapi.io&quot;, &quot;first_name&quot;: &quot;fullstack&quot;, &quot;is_superuser&quot;: false, &quot;last_name&quot;: &quot;api&quot;, &quot;password&quot;: &quot;fullstackapi_pass&quot;, &quot;username&quot;: &quot;fullstackapi&quot; }&#x27;</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> jq .id</span><span class="token variable" style="color:#36acaa">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>10- Create a credential type to store harshicorp vault token so it can be used later to request secrets. You could try to use the specific harshicorp vault credential type that AWX already has, but we&#x27;ll be using a custom one</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">AWX_VAULT_CREDENTIAL_TYPE</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">curl</span><span class="token variable" style="color:#36acaa"> -sk --request POST https://admin:awx-fullstackautomationpass@localhost:8043/api/v2/credential_types/ -H </span><span class="token variable string" style="color:#e3116c">&quot;Content-Type: application/json&quot;</span><span class="token variable" style="color:#36acaa"> --data </span><span class="token variable string" style="color:#e3116c">&#x27;{&quot;name&quot;: &quot;Custom Vault Cred Type&quot;,&quot;description&quot;: &quot;Custom credential type to store vault token&quot;,&quot;kind&quot;: &quot;cloud&quot;,&quot;inputs&quot;: { &quot;fields&quot;: [ {&quot;id&quot;: &quot;vault_server&quot;,&quot;type&quot;: &quot;string&quot;,&quot;label&quot;: &quot;URL to Vault Server (i.e: http://127.0.0.1:5555/)&quot; },{ &quot;id&quot;: &quot;vault_token&quot;,&quot;type&quot;: &quot;string&quot;,&quot;label&quot;: &quot;Vault token&quot;,&quot;secret&quot;: true}],&quot;required&quot;: [&quot;vault_server&quot;,&quot;vault_token&quot;]},&quot;injectors&quot;: { &quot;extra_vars&quot;: { &quot;vault_server&quot;: &quot;{{ vault_server }}&quot;,   &quot;vault_token&quot;: &quot;{{ vault_token }}&quot;}}}&#x27;</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> jq .id</span><span class="token variable" style="color:#36acaa">`</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>11- Create a credential to store vault token and url, using the credential type just created</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">AWX_VAULT_CREDENTIAL</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">`</span><span class="token variable function" style="color:#d73a49">curl</span><span class="token variable" style="color:#36acaa"> -sk --request POST https://admin:awx-fullstackautomationpass@localhost:8043/api/v2/organizations/$AWX_ORG_ID/credentials/ -H </span><span class="token variable string" style="color:#e3116c">&quot;Content-Type: application/json&quot;</span><span class="token variable" style="color:#36acaa"> --data </span><span class="token variable string" style="color:#e3116c">&quot;{</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">credential_type</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">: </span><span class="token variable string variable" style="color:#36acaa">$AWX_VAULT_CREDENTIAL_TYPE</span><span class="token variable string" style="color:#e3116c">,</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">description</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">: </span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">vault credential</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">, </span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">inputs</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">:{</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">vault_server</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">:</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">http://127.0.0.1:9200</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">,</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">vault_token</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">:</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">fullstackautomation-root-token-vault2</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">}, </span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">name</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">: </span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">vault_credential</span><span class="token variable string entity" style="color:#36acaa">\&quot;</span><span class="token variable string" style="color:#e3116c">}&quot;</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable operator" style="color:#393A34">|</span><span class="token variable" style="color:#36acaa"> jq .id</span><span class="token variable" style="color:#36acaa">`</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Everything is set to use AWX in the architecture. On further steps, after we create our repos on gitlab, we&#x27;ll be creating projects, inventories and templates. All linked to the gitlab source.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_xD8n"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/automation">automation</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/awx">awx</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/ansible">ansible</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/gitlab">gitlab</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/network-automation">network automation</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/terraform">terraform</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/playbook">playbook</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/tags/inventory">inventory</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/liviozanol/liviozanol.github.io/blog/2021-12-08-automation-4/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/full-stack-it-automation-part-5-gitlabci"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« <!-- -->Full-Stack Automation Part 5 - Gitlab CI</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/full-stack-it-automation-part-3-Vault"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Full-Stack Automation Part 3 - Vault<!-- --> Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ansible-awx" class="table-of-contents__link toc-highlight">Ansible/AWX</a></li><li><a href="#ansible-role" class="table-of-contents__link toc-highlight">Ansible/AWX Role</a></li><li><a href="#ansible-alternatives" class="table-of-contents__link toc-highlight">Ansible/AWX Alternatives</a></li><li><a href="#ansible-install-config" class="table-of-contents__link toc-highlight">Ansible/AWX Installation and Configuration</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Livio Zanol Puppim (livio@zanol.com.br). Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.767ad4ec.js"></script>
<script src="/assets/js/main.9605fe9c.js"></script>
</body>
</html>